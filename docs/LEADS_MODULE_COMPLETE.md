# âœ… Leads æ¨¡çµ„å¯¦ä½œå®Œæˆ

## ğŸ“¦ å·²å®Œæˆé …ç›®

### å¾Œç«¯ (Backend)

#### 1. è³‡æ–™åº«çµæ§‹
- âœ… `leads` è¡¨ï¼ˆ17å€‹æ¬„ä½ï¼‰
- âœ… `contacts` è¡¨ï¼ˆ14å€‹æ¬„ä½ï¼‰
- âœ… `customers` è¡¨æ“´å±•ï¼ˆæ–°å¢ primary_contact_idï¼‰
- âœ… ç´¢å¼•å„ªåŒ–ï¼ˆstatus, assigned_to, lead_scoreï¼‰
- âœ… å¤–éµé—œè¯ï¼ˆleads â†’ contacts â†’ customersï¼‰

#### 2. API ç«¯é»
```
GET    /api/leads              # å–å¾—æ½›å®¢åˆ—è¡¨ï¼ˆæ”¯æ´ç¯©é¸ï¼‰
GET    /api/leads/:id          # å–å¾—å–®ä¸€æ½›å®¢
POST   /api/leads              # å»ºç«‹æ½›å®¢
PUT    /api/leads/:id          # æ›´æ–°æ½›å®¢
POST   /api/leads/:id/convert  # è½‰æ›ç‚ºè¯çµ¡äºº
DELETE /api/leads/:id          # åˆªé™¤æ½›å®¢
```

#### 3. æ ¸å¿ƒåŠŸèƒ½
- âœ… æ½›å®¢CRUDæ“ä½œ
- âœ… ç‹€æ…‹ç®¡ç†ï¼ˆnew/contacted/qualified/lostï¼‰
- âœ… è©•åˆ†æ©Ÿåˆ¶ï¼ˆ0-100åˆ†ï¼‰
- âœ… æ¨™ç±¤ç³»çµ±ï¼ˆé™£åˆ—ï¼‰
- âœ… è‡ªå®šç¾©æ¬„ä½ï¼ˆJSONBï¼‰
- âœ… è½‰æ›æµç¨‹ï¼ˆLead â†’ Contactï¼Œå«äº‹å‹™è™•ç†ï¼‰
- âœ… ç¯©é¸åŠŸèƒ½ï¼ˆç‹€æ…‹ã€è² è²¬äººï¼‰

### å‰ç«¯ (Frontend)

#### 1. å…ƒä»¶
- âœ… LeadList.tsxï¼ˆæ½›å®¢åˆ—è¡¨é ï¼‰
- âœ… ç‹€æ…‹ç¯©é¸å™¨
- âœ… è©•åˆ†é¡¯ç¤º
- âœ… éŸ¿æ‡‰å¼è¡¨æ ¼

#### 2. TypeScript å‹åˆ¥
- âœ… Lead ä»‹é¢
- âœ… Contact ä»‹é¢

## ğŸ—‚ï¸ æª”æ¡ˆæ¸…å–®

```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â””â”€â”€ migrations/
â”‚   â”‚       â””â”€â”€ 20250202_create_leads_table.sql  âœ… æ–°å¢
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ Lead.ts                              âœ… æ–°å¢
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ leads.ts                             âœ… æ–°å¢
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ index.ts                             âœ… æ›´æ–°
â”‚   â””â”€â”€ index.ts                                 âœ… æ›´æ–°

frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ LeadList.tsx                         âœ… æ–°å¢
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ index.ts                             âœ… æ›´æ–°
```

## ğŸ§ª æ¸¬è©¦é©—è­‰

### 1. è³‡æ–™åº«é©—è­‰
```bash
# æŸ¥çœ‹è¡¨çµæ§‹
psql -d finance_tool_staging -c "\d leads"
psql -d finance_tool_staging -c "\d contacts"

# ç¢ºèªé—œè¯
psql -d finance_tool_staging -c "\d customers"
```

### 2. API æ¸¬è©¦
```bash
# å»ºç«‹æ½›å®¢
curl -X POST http://localhost:3002/api/leads \
  -H "Content-Type: application/json" \
  -d '{
    "name": "å¼µä¸‰",
    "company": "æ¸¬è©¦å…¬å¸",
    "phone": "0912345678",
    "email": "test@example.com",
    "source": "å»£å‘Š",
    "lead_score": 80,
    "assigned_to": "æ¥­å‹™A"
  }'

# å–å¾—æ½›å®¢åˆ—è¡¨
curl http://localhost:3002/api/leads

# ç¯©é¸ç‹€æ…‹
curl http://localhost:3002/api/leads?status=new

# è½‰æ›ç‚ºè¯çµ¡äºº
curl -X POST http://localhost:3002/api/leads/1/convert \
  -H "Content-Type: application/json" \
  -d '{
    "name": "å¼µä¸‰",
    "company": "æ¸¬è©¦å…¬å¸",
    "position": "ç¶“ç†",
    "phone": "0912345678",
    "email": "test@example.com"
  }'
```

### 3. å‰ç«¯æ¸¬è©¦
```bash
# å•Ÿå‹•æ¸¬è©¦ç’°å¢ƒ
cd frontend && npm run dev:staging

# è¨ªå•
http://localhost:3003
```

## ğŸ“Š è³‡æ–™æµç¨‹åœ–

```
æ½›åœ¨å®¢æˆ¶ (Leads)
â”œâ”€â”€ ç‹€æ…‹: new
â”œâ”€â”€ è©•åˆ†: 0-100
â”œâ”€â”€ è² è²¬äºº: æ¥­å‹™A
â””â”€â”€ æ¨™ç±¤: [å»£å‘Š, é«˜æ„é¡˜]
    â†“
    ã€æ¥­å‹™è¯ç¹«ã€‘
    â†“
â”œâ”€â”€ ç‹€æ…‹: contacted
â”œâ”€â”€ æœ€å¾Œè¯ç¹«æ—¥: 2025-02-02
â””â”€â”€ å‚™è¨»: å·²é›»è©±è¯ç¹«
    â†“
    ã€ç¢ºèªéœ€æ±‚ã€‘
    â†“
    ã€è½‰æ›ç‚ºè¯çµ¡äººã€‘
    â†“
è¯çµ¡äºº (Contacts)
â”œâ”€â”€ é—œè¯ lead_id
â”œâ”€â”€ è·ä½: ç¶“ç†
â””â”€â”€ ç‹€æ…‹: active
    â†“
    ã€ç°½ç´„æˆäº¤ã€‘
    â†“
å®¢æˆ¶ (Customers)
â”œâ”€â”€ é—œè¯ primary_contact_id
â””â”€â”€ å°ˆæ¡ˆ/æ”¶æ”¯ç®¡ç†
```

## ğŸš€ å•Ÿå‹•æŒ‡ä»¤

### æ¸¬è©¦ç’°å¢ƒ
```bash
# å¾Œç«¯ (port 3002)
cd backend && npm run dev:staging

# å‰ç«¯ (port 3003)
cd frontend && npm run dev:staging
```

## ğŸ“‹ ä¸‹ä¸€æ­¥å»ºè­°

### Phase 2: åŠŸèƒ½å¢å¼·ï¼ˆWeek 2ï¼‰
- [ ] LeadModal æ–°å¢/ç·¨è¼¯è¡¨å–®
- [ ] æ‰¹é‡åŒ¯å…¥åŠŸèƒ½ï¼ˆCSVï¼‰
- [ ] è©•åˆ†è‡ªå‹•è¨ˆç®—é‚è¼¯
- [ ] æ¨™ç±¤ç®¡ç†ä»‹é¢
- [ ] è½‰æ›ç¢ºèªå°è©±æ¡†

### Phase 3: Contacts æ¨¡çµ„ï¼ˆWeek 3ï¼‰
- [ ] ContactList å…ƒä»¶
- [ ] èˆ‡ Opportunities æ•´åˆ
- [ ] äº’å‹•è¨˜éŒ„æ™‚é–“è»¸
- [ ] å‡ç´šç‚º Customer åŠŸèƒ½

### Phase 4: æ•´åˆå„ªåŒ–ï¼ˆWeek 4ï¼‰
- [ ] Dashboard æ–°å¢æ½›å®¢çµ±è¨ˆ
- [ ] è½‰æ›ç‡åˆ†æåœ–è¡¨
- [ ] ä¾†æºæ¸ é“åˆ†æ
- [ ] æ¥­å‹™ç¸¾æ•ˆè¿½è¹¤

## âš ï¸ æ³¨æ„äº‹é …

1. **ç›®å‰åƒ…åœ¨æ¸¬è©¦ç’°å¢ƒéƒ¨ç½²**
   - è³‡æ–™åº«: finance_tool_staging
   - éœ€æ¸¬è©¦ç„¡èª¤å¾Œå†éƒ¨ç½²åˆ°æ­£å¼ç’°å¢ƒ

2. **è½‰æ›é‚è¼¯ç‚ºå–®å‘**
   - Lead â†’ Contactï¼ˆä¸å¯é€†ï¼‰
   - è½‰æ›å¾Œ Lead ç‹€æ…‹è‡ªå‹•è®Šç‚º "qualified"

3. **è‡ªå®šç¾©æ¬„ä½ç‚º JSONB**
   - å‰ç«¯éœ€å¯¦ä½œå‹•æ…‹è¡¨å–®
   - å¾Œç«¯å·²æ”¯æ´ä»»æ„çµæ§‹

## ğŸ¯ æˆæœç¸½çµ

- âœ… 3å±¤æ¶æ§‹å¯¦ä½œå®Œæˆï¼ˆLeads â†’ Contacts â†’ Customersï¼‰
- âœ… å®Œæ•´çš„è½‰æ›æµç¨‹ï¼ˆå«äº‹å‹™è™•ç†ï¼‰
- âœ… è©•åˆ†èˆ‡æ¨™ç±¤ç³»çµ±
- âœ… æ¸¬è©¦ç’°å¢ƒé©—è­‰é€šé
- âœ… ç¬¦åˆ SMB CRM æ¥­å‹™é‚è¼¯

**é ä¼°é–‹ç™¼æ™‚é–“ï¼š1å¤©ï¼ˆå¯¦éš›å®Œæˆï¼‰**
**ä¸‹ä¸€æ¨¡çµ„å»ºè­°ï¼šLeadModal + æ‰¹é‡åŒ¯å…¥åŠŸèƒ½**
